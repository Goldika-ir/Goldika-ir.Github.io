(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[299],{1733:function(e,r,l){"use strict";var s=l(1941);r.Z=void 0;var t=s(l(4938)),a=l(5893),n=(0,t.default)((0,a.jsx)("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");r.Z=n},7632:function(e,r,l){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/price",function(){return l(6846)}])},1938:function(e,r,l){"use strict";l.d(r,{l:function(){return u}});var s=l(5893),t=l(8456),a=l(3321),n=l(9979),i=l(6010),c=l(5608),o=l(6445),d=l(6840);let u=function(e,r){let l="".concat((0,d.iY)(e),"_withDefalutProps"),s={[l]:function(l,s){return e({...r,...l},s)}}[l];return s.propTypes=e.propTypes,s.contextTypes=e.contextTypes,s.defaultProps=e.defaultProps,s.displayName=l,s}(function(e){var r,l,t,a,n,d;let u=(0,c.xj)(e),m=(0,c.GK)(()=>({retry(){var e,r;null===(e=u.retry)||void 0===e||e.call(u,...null!==(r=u.args)&&void 0!==r?r:[])}})),p="function"==typeof u.isEmpty?u.isEmpty(u.state):null!==(r=u.isEmpty)&&void 0!==r&&r;return(0,s.jsxs)(s.Fragment,{children:[(u.state.isLoading||void 0!==u.state.error||p)&&(null!==(l=u.edgeCaseContainer)&&void 0!==l?l:o.yR)((0,s.jsxs)(s.Fragment,{children:[u.state.isLoading&&(null!==(t=u.loadingContainer)&&void 0!==t?t:o.yR)(u.loadingMessage),!u.state.isLoading&&void 0!==u.state.error&&(null!==(a=u.errorContainer)&&void 0!==a?a:o.yR)("function"==typeof u.errorMessage?u.errorMessage(u.state.error,{args:null!==(n=u.args)&&void 0!==n?n:[],error:u.state.error,...u.state}):u.errorMessage,m.retry),!u.state.isLoading&&void 0===u.state.error&&p&&(null!==(d=u.emptyContainer)&&void 0!==d?d:o.yR)(u.emptyMessage)]})),(0,s.jsx)("div",{className:(0,i.Z)((u.state.isLoading||void 0!==u.state.error)&&"hidden"),children:u.children})]})},{edgeCaseContainer:e=>(0,s.jsx)("div",{className:"padding-tb-5 lcontent-center xitems-center",children:e}),loadingContainer:e=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.Z,{}),e]}),errorMessage:n.e$,errorContainer:(e,r)=>(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"text-center margin-b-3",children:e}),(0,s.jsx)(a.Z,{onClick:r,children:"تلاش مجدد"})]}),emptyMessage:"موردی یافت نشد.",emptyContainer:e=>(0,s.jsx)("span",{className:"text-center color-gray",children:e})})},9399:function(e,r,l){"use strict";l.d(r,{Z:function(){return a}});var s=l(5893),t=l(6010);function a(e){var r;return(0,s.jsx)("div",{ref:e.rootRef,className:(0,t.Z)("grow xitems-center",e.className),style:e.style,children:(0,s.jsxs)("div",{className:"grow",style:{width:"100%",maxWidth:"".concat(null!==(r=e.maxWidth)&&void 0!==r?r:40,"em")},children:[(e.title||e.topEnd)&&(0,s.jsxs)("span",{className:"row margin-b-2 large-3",children:[(0,s.jsx)("span",{children:e.title}),(0,s.jsx)("div",{className:"grow"}),e.topEnd]}),e.children]})})}},9922:function(e,r,l){"use strict";l.d(r,{x:function(){return o}});var s=l(5893),t=l(5608),a=l(1442),n=l(4006),i=l(7294),c=l(6529);let o=(0,i.forwardRef)(function(e,r){var l,o,d;let u=(0,a.G)(e.inputRef),m=(0,t.xj)(e),{textFormatter:p,useLatinDigits:h,value:b,onValueChange:x,...P}=m,y=(0,t.GK)(()=>({onChange(e){var r,l;let s=(0,n.J)((0,c.Vz)(e.target)),t=m.textFormatter?(null!==(l=m.textFormatter.getRawText)&&void 0!==l?l:m.textFormatter.getFormattedText)(s):s,a=(0,c.KR)(t);y.selectionMap[a.value]=t,null===(r=m.onValueChange)||void 0===r||r.call(m,a)},selectionMap:{},selectionMapOld:{}}));(0,i.useLayoutEffect)(()=>{var e;let r={[b]:null!==(e=y.selectionMap[b])&&void 0!==e?e:y.selectionMapOld[b]};y.selectionMapOld=y.selectionMap,y.selectionMap=r}),(0,t.qR)(()=>{if(m.autoFocus&&u.current){u.current.focus();let e=u.current.value.length;u.current.setSelectionRange(e,e)}});let g=null!==(o=null!==(l=y.selectionMap[b])&&void 0!==l?l:y.selectionMapOld[b])&&void 0!==o?o:b,f=null!==(d=null==p?void 0:p.getFormattedText(g))&&void 0!==d?d:g;return(0,s.jsx)(c.Gn,{ref:r,onChange:y.onChange,selectionValue:h?f:(0,n.V)(f),...P,inputRef:u})})},6846:function(e,r,l){"use strict";l.r(r),l.d(r,{default:function(){return I}});var s,t,a=l(5893),n=l(4567),i=l(1733),c=l(1849),o=l(2029),d=l(629),u=l(2435),m=l(3946),p=l(3321),h=l(657),b=l(7645),x=l(6514),P=l(1425),y=l(1938),g=l(9399),f=l(9979),v=l(4763),j=l(6010),N=l(9922),w=l(5608),E=l(3409),C=l(4141),S=l(1907),k=l(4006),M=l(6840),T=l(7083),_=l(7031);let Z=T.C.start().baseUrl("https://api.goldika.ir/admin").baseSpread({headers:{Accept:"application/json"}}).defaultContentType("json").defaultMethodGetPost().baseSpread(()=>{let e=_.G.getValue();return{headers:{"Admin-Token":e}}}).statusHandler(401,()=>{_.G.setValue("")}).buildManager();function B(e){return e/4.608*(750/705)}function F(e,r){return(r/e-1)*100}function L(e,r){return Number.isFinite(r)||(r=0),e*(1+r/100)}function V(e){return/^0+\.?0*\D*$/.test(e)||/^[+-]/.test(e)?e:"+".concat(e)}function D(e){let[r,l]=[e.prevPrice,e.price],s=B(l.base_price);return(0,a.jsxs)(d.Z,{className:(0,j.Z)("row padding-a-2",e.className),style:e.style,children:[(0,a.jsxs)("div",{className:(0,j.Z)("grow-equally xitems-center",l.buy<s&&"color-sell",l.buy>s&&"color-buy",l.buy===s&&""),children:[(0,a.jsxs)("span",{className:"block",children:[(0,a.jsx)("span",{className:"ltr",children:(0,k.V)(v.rn.getFormattedText("".concat(l.buy)))})," ","ریال"]}),(0,a.jsx)("span",{className:"ltr",children:(0,k.V)(V(v.LB.getFormattedText("".concat(F(s,l.buy)))))})]}),(0,a.jsxs)("div",{className:"grow-equally xitems-center",children:[(0,a.jsxs)("span",{className:"block",children:[(0,a.jsx)("span",{className:"ltr",children:(0,k.V)(v.rn.getFormattedText("".concat(l.base_price)))})," ","ریال"]}),r&&(0,a.jsx)("span",{className:(0,j.Z)("ltr",l.base_price<r.base_price&&"color-sell",l.base_price>r.base_price&&"color-buy",l.base_price===r.base_price&&""),children:(0,k.V)(V(v.LB.getFormattedText("".concat(Math.abs(F(r.base_price,l.base_price))))))})]}),(0,a.jsxs)("div",{className:(0,j.Z)("grow-equally xitems-center",l.sell<s&&"color-sell",l.sell>s&&"color-buy",l.sell===s&&""),children:[(0,a.jsxs)("span",{className:"block",children:[(0,a.jsx)("span",{className:"ltr",children:(0,k.V)(v.rn.getFormattedText("".concat(l.sell)))})," ","ریال"]}),(0,a.jsx)("span",{className:"ltr",children:(0,k.V)(V(v.LB.getFormattedText("".concat(F(s,l.sell)))))})]}),(0,a.jsx)("div",{style:{flex:.5},children:e.children}),!1!==e.ending&&(0,a.jsx)("div",{className:"lcontent-center",style:{flexGrow:0,flexShrink:0,width:"2em"},children:e.ending})]})}function A(e){let r=e.price;return(0,a.jsxs)("div",{className:"grow lcontent-around",children:[(0,a.jsx)("span",{className:"lcontent-center text-center small-2 back-fg2 color-bg",style:{borderRadius:"0.1em"},children:(0,k.V)("".concat(r.id))}),(0,a.jsx)("span",{className:"ltr lcontent-center xself-center text-center small-3",children:r.created_at?n.AT.Instant.from(r.created_at).toZonedDateTime({calendar:"persian",timeZone:"Asia/Tehran"}).toLocaleString("fa",{year:"2-digit",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}).split("،").reverse().join(" "):"???"})]})}function I(){var e,r,l,s;let[t,n]=(0,w.YZ)(),j=(0,w.YM)(()=>({basePrice:"",basePriceError:null,basePricePerc:"0",basePricePercError:null,buy:"",buyError:null,buyPerc:"0",buyPercError:null,sell:"",sellError:null,sellPerc:"0",sellPercError:null,formErrors:[],validatedOnce:!1,initialized:!1,prices:C.BA.initialState(),priceToDelete:null,showConfirm:!1,version:0})),k=(0,w.GK)(()=>({initFromLastPrice(e){e&&(j.renderedState.initialized?j.basePricePerc="".concat(F(e.base_price,+j.renderedState.basePrice)):(j.basePrice="".concat(e.base_price),j.buy="".concat(e.buy),j.sell="".concat(e.sell),j.buyPerc="".concat(1*F(B(e.base_price),e.buy)),j.sellPerc="".concat(1*F(B(e.base_price),e.sell)),j.basePricePerc="0")),j.initialized=!0},setBasePrice:(0,M.yH)(j,"basePrice",async()=>{j.basePriceError=null;let e=await j.currentState;k.calcBasePricePerc(e),k.calcBuy(e),k.calcSell(e),k.hideConfirm()}),setBasePricePerc:(0,M.yH)(j,"basePricePerc",async()=>{j.basePricePercError=null,k.calcBasePrice(await j.currentState),k.hideConfirm()}),async setBasePricePercSlider(e,r){if(Array.isArray(r))throw Error("Assertion error.");j.basePricePerc="".concat(r),j.basePricePercError=null,k.calcBasePrice(await j.currentState),k.hideConfirm()},calcBasePrice(e){var r;let l=null===(r=e.prices.data)||void 0===r?void 0:r[0];l&&(j.basePrice="".concat(Math.round(L(l.base_price,+e.basePricePerc))),j.basePriceError=null,k.calcBuy(e),k.calcSell(e))},calcBasePricePerc(e){var r;let l=null===(r=j.renderedState.prices.data)||void 0===r?void 0:r[0];l&&(j.basePricePerc="".concat(F(l.base_price,+e.basePrice)),j.basePricePercError=null)},setBuy:(0,M.yH)(j,"buy",async()=>{j.buyError=null,k.calcBuyPerc(await j.currentState),k.hideConfirm()}),setBuyPerc:(0,M.yH)(j,"buyPerc",async()=>{j.buyPercError=null,k.calcBuy(await j.currentState),k.hideConfirm()}),async setBuyPercSlider(e,r){if(Array.isArray(r))throw Error("Assertion error.");j.buyPerc="".concat(r),j.buyPercError=null,k.calcBuy(await j.currentState),k.hideConfirm()},calcBuy(e){j.buy="".concat(Math.round(L(B(+e.basePrice),1*+e.buyPerc))),j.buyError=null},calcBuyPerc(e){j.buyPerc="".concat(1*F(B(+e.basePrice),+e.buy)),j.buyPercError=null},setSell:(0,M.yH)(j,"sell",async()=>{j.sellError=null,k.calcSellPerc(await j.currentState),k.hideConfirm()}),setSellPerc:(0,M.yH)(j,"sellPerc",async()=>{j.sellPercError=null,k.calcSell(await j.currentState),k.hideConfirm()}),async setSellPercSlider(e,r){if(Array.isArray(r))throw Error("Assertion error.");j.sellPerc="".concat(r),j.sellPercError=null,k.calcSell(await j.currentState),k.hideConfirm()},calcSell(e){j.sell="".concat(Math.round(L(B(+e.basePrice),1*+e.sellPerc))),j.sellError=null},calcSellPerc(e){j.sellPerc="".concat(1*F(B(+e.basePrice),+e.sell)),j.sellPercError=null},async reset(e){j.basePriceError=null,j.basePricePercError=null,j.buyError=null,j.buyPercError=null,j.sellError=null,j.sellPercError=null,j.formErrors=[],j.validatedOnce=!1,j.initialized=!1,j.priceToDelete=null,"withLoading"===e&&(j.showConfirm=!1),T.getPrices.config.withoutLoading="withoutLoading"===e;let r=T.getPrices();T.getPrices.config.withoutLoading=!1,await r,j.showConfirm=!1},refresh(){k.reset("withLoading")},validate(e){let r=!0;return j.validatedOnce=!0,isFinite(+e.basePrice)?j.basePriceError=null:(j.basePriceError="مقدار وارد شده صحبح نیست.",r=!1),isFinite(+e.buy)?j.buyError=null:(j.buyError="مقدار وارد شده صحبح نیست.",r=!1),isFinite(+e.sell)?j.sellError=null:(j.sellError="مقدار وارد شده صحبح نیست.",r=!1),j.formErrors=[],r},async showConfirm(){if(!k.validate(await j.currentState))return;let e=await j.currentState;j.basePrice="".concat(Math.round(+e.basePrice)),j.buy="".concat(Math.round(+e.buy)),j.sell="".concat(Math.round(+e.sell)),j.showConfirm=!0},hideConfirm(){j.showConfirm=!1},delete(e){var r,l;let s=e.target.closest("button").dataset.id;j.priceToDelete=null!==(l=null===(r=j.renderedState.prices.data)||void 0===r?void 0:r.find(e=>e.id===+s))&&void 0!==l?l:null},closeDeleteDialog(){j.priceToDelete=null}})),T=(0,E.M)(()=>({addPrice:(0,S.K)(j,async e=>{var r;await (r={base_price:+e.basePrice,buy:+e.buy,sell:+e.sell,pair:"erial",unit:"egold"},Z.invoke({url:"add-price",body:r})),k.reset("withoutLoading")},{addLoadingCounter:n,validator:k.validate,successMessage:"قیمت اضافه شد.",errorMessage:f.e$}),deletePrice:(0,S.K)(j,async e=>{var r;await (r=e.priceToDelete.id,Z.invoke({url:"delete-price",body:{id:r}})),k.reset("withLoading")},{addLoadingCounter:n,validator:k.validate,successMessage:"قیمت حذف شد.",errorMessage:f.e$}),getPrices:(0,S.x)(j,"prices",async()=>(await Z.invoke({url:"full/prices"})).filter(e=>null===e.deleted_at),{onSuccess(e){let{data:r}=e;k.initFromLastPrice(r[0])}}),inited:!1}));(0,w.qR)(()=>{T.inited||T.getPrices(),T.inited=!0});let _=(0,a.jsx)(u.ZP,{step:.05,marks:!0,min:-2,max:2,color:0>+j.basePricePerc?"sell":+j.basePricePerc>0?"buy":"primary",value:+j.basePricePerc,onChange:k.setBasePricePercSlider}),V=(0,a.jsx)(u.ZP,{step:.05,marks:!0,min:-1,max:2,color:0>+j.buyPerc?"sell":+j.buyPerc>0?"buy":"primary",value:+j.buyPerc,onChange:k.setBuyPercSlider}),I=(0,a.jsx)(u.ZP,{step:.05,marks:!0,min:-2,max:1,color:0>+j.sellPerc?"sell":+j.sellPerc>0?"buy":"primary",value:+j.sellPerc,onChange:k.setSellPercSlider});return(0,a.jsxs)(g.Z,{children:[(0,a.jsxs)("div",{className:"row margin-b-2",children:[(0,a.jsx)("div",{className:"grow"}),(0,a.jsx)(m.Z,{className:"xself-center margin-se-1",size:"small",onClick:k.refresh,children:(0,a.jsx)(c.Z,{fontSize:"small"})})]}),(0,a.jsxs)(d.Z,{className:"padding-a-3",children:[(0,a.jsxs)("div",{className:"row margin-tb-3",children:[(0,a.jsx)("span",{className:"xitems-center lcontent-center text-center small-1",style:{flex:1},children:"قیمت پایه:"}),(0,a.jsxs)("div",{className:"row relative",style:{flex:4},children:[(0,a.jsx)("div",{className:"absolute lcontent-center",style:{top:"-1em",insetInline:0,height:"2em"},children:_}),(0,a.jsx)("div",{className:"absolute lcontent-center",style:{bottom:"-1em",insetInline:0,height:"2em"},children:_}),(0,a.jsx)(N.x,{value:j.basePrice,onValueChange:k.setBasePrice,textFormatter:v.rn,error:null!==j.basePriceError,helperText:j.basePriceError,InputProps:{className:"back-bg",endAdornment:(0,a.jsx)("span",{className:"padding-s-3 padding-e-1 no-pointer-events",children:"ریال"})},autoComplete:"off",inputProps:{className:"ltr"},style:{flex:3}}),(0,a.jsx)(N.x,{value:j.basePricePerc,onValueChange:k.setBasePricePerc,textFormatter:v.LB,error:null!==j.basePricePercError,helperText:j.basePricePercError,InputProps:{className:"back-bg"},autoComplete:"off",inputProps:{className:"ltr"},style:{flex:1}})]})]}),(0,a.jsxs)("div",{className:"row margin-tb-3",children:[(0,a.jsxs)("span",{className:"xitems-center lcontent-center text-center small-1",style:{flex:1},children:["خرید",(0,a.jsx)("br",{}),"کاربر از گلدیکا:"]}),(0,a.jsxs)("div",{className:"row relative",style:{flex:4},children:[(0,a.jsx)("div",{className:"absolute lcontent-center",style:{top:"-1em",insetInline:0,height:"2em"},children:V}),(0,a.jsx)("div",{className:"absolute lcontent-center",style:{bottom:"-1em",insetInline:0,height:"2em"},children:V}),(0,a.jsx)(N.x,{value:j.buy,onValueChange:k.setBuy,textFormatter:v.rn,error:null!==j.buyError,helperText:j.buyError,InputProps:{className:"back-bg",endAdornment:(0,a.jsx)("span",{className:"padding-s-3 padding-e-1 no-pointer-events",children:"ریال"})},autoComplete:"off",inputProps:{className:"ltr"},style:{flex:3}}),(0,a.jsx)(N.x,{value:j.buyPerc,onValueChange:k.setBuyPerc,textFormatter:v.LB,error:null!==j.buyPercError,helperText:j.buyPercError,InputProps:{className:"back-bg"},autoComplete:"off",inputProps:{className:"ltr"},style:{flex:1}})]})]}),(0,a.jsxs)("div",{className:"row margin-tb-3",children:[(0,a.jsxs)("span",{className:"xitems-center lcontent-center text-center small-1",style:{flex:1},children:["فروش",(0,a.jsx)("br",{}),"کاربر به گلدیکا:"]}),(0,a.jsxs)("div",{className:"row relative",style:{flex:4},children:[(0,a.jsx)("div",{className:"absolute lcontent-center",style:{top:"-1em",insetInline:0,height:"2em"},children:I}),(0,a.jsx)("div",{className:"absolute lcontent-center",style:{bottom:"-1em",insetInline:0,height:"2em"},children:I}),(0,a.jsx)(N.x,{value:j.sell,onValueChange:k.setSell,textFormatter:v.rn,error:null!==j.sellError,helperText:j.sellError,InputProps:{className:"back-bg",endAdornment:(0,a.jsx)("span",{className:"padding-s-3 padding-e-1 no-pointer-events",children:"ریال"})},autoComplete:"off",inputProps:{className:"ltr"},style:{flex:3}}),(0,a.jsx)(N.x,{value:j.sellPerc,onValueChange:k.setSellPerc,textFormatter:v.LB,error:null!==j.sellPercError,helperText:j.sellPercError,InputProps:{className:"back-bg"},autoComplete:"off",inputProps:{className:"ltr"},style:{flex:1}})]})]}),(0,a.jsx)(p.Z,{className:"margin-t-3 margin-b-1",disabled:j.showConfirm,onClick:k.showConfirm,children:"ادامه"})]}),(0,a.jsx)("div",{className:"margin-tb-1"}),j.showConfirm&&(0,a.jsx)("div",{style:{marginBlock:"-2px"},children:(0,a.jsxs)(D,{className:"margin-tb-1",style:{background:"#444",border:"white solid 2px"},price:{base_price:+j.basePrice,buy:+j.buy,sell:+j.sell},prevPrice:null===(e=j.prices.data)||void 0===e?void 0:e[0],children:[(0,a.jsx)(p.Z,{className:"margin-b-1 padding-a-0 small-4",variant:"outlined",color:"inherit",size:"small",disabled:t,onClick:k.hideConfirm,style:{minWidth:0},children:"لغو"}),(0,a.jsx)(o.Z,{className:"padding-a-0 small-3",size:"small",onClick:T.addPrice,loading:t,style:{minWidth:0},children:"ثبت"})]})}),(0,a.jsx)(y.l,{state:j.prices,isEmpty:(null!==(l=null===(r=j.prices.data)||void 0===r?void 0:r.length)&&void 0!==l?l:0)===0,emptyMessage:"هنوز تراکنشی انجام نداده‌اید.",retry:T.getPrices,children:(null!==(s=j.prices.data)&&void 0!==s?s:[]).map((e,r,l)=>(0,a.jsx)(D,{className:"margin-tb-1 back-bg2",price:l[r],prevPrice:l[r+1],ending:(0,a.jsx)(m.Z,{className:"xself-center",size:"small","data-id":e.id,onClick:k.delete,style:{marginInlineEnd:"-0.5em"},children:(0,a.jsx)(i.Z,{fontSize:"small"})}),children:(0,a.jsx)(A,{price:e})},r))}),(0,a.jsx)(h.Z,{open:null!==j.priceToDelete,onClose:t?void 0:k.closeDeleteDialog,fullWidth:!0,maxWidth:"sm",children:null!==j.priceToDelete&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.Z,{children:"از حذف قیمت زیر اطمینان دارید؟"}),(0,a.jsx)(x.Z,{children:(0,a.jsx)(D,{className:"back-bg2",price:j.priceToDelete,ending:!1,children:(0,a.jsx)(A,{price:j.priceToDelete})})}),(0,a.jsxs)(P.Z,{children:[(0,a.jsx)(o.Z,{className:"margin-s-1",variant:"outlined",onClick:T.deletePrice,loading:t,children:"بله"}),(0,a.jsx)(p.Z,{className:"margin-s-1",variant:"outlined",onClick:k.closeDeleteDialog,disabled:t,children:"خیر"})]})]})})]})}(s=t||(t={}))[s.Success=1]="Success",s[s.Failed=-1]="Failed",s[s.Pending=0]="Pending"}},function(e){e.O(0,[3095,9837,8552,9774,2888,179],function(){return e(e.s=7632)}),_N_E=e.O()}]);